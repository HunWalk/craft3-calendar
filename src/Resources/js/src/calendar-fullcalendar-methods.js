"use strict";function _defineProperty(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}var _slicedToArray=function(){function e(e,a){var n=[],t=!0,r=!1,i=void 0;try{for(var l,d=e[Symbol.iterator]();!(t=(l=d.next()).done)&&(n.push(l.value),!a||n.length!==a);t=!0);}catch(o){r=!0,i=o}finally{try{!t&&d["return"]&&d["return"]()}finally{if(r)throw i}}return n}return function(a,n){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a))return e(a,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),$solspaceCalendar=$("#solspace-calendar"),$solspaceCalendarSpinner=null,_$calendar$data=$calendar.data(),isMultiSite=_$calendar$data.isMultiSite,overlapThreshold=_$calendar$data.overlapThreshold,language=_$calendar$data.language,firstDayOfWeek=_$calendar$data.firstDayOfWeek,renderEvent=function(e,a){if(e.allDay&&a.addClass("fc-event-all-day"),e.end){if(e.multiDay||e.allDay)a.addClass("fc-event-multi-day");else{a.addClass("fc-event-single-day");var n=$("<span />").addClass("fc-color-icon").css("background-color",e.backgroundColor).css("border-color",e.borderColor);$(".fc-content",a).prepend(n)}e.enabled||a.addClass("fc-event-disabled"),a.addClass("fc-color-"+e.textColor),buildEventPopup(e,a)}},today=new moment,renderDay=function(e,a){var n=a.parents(".fc-bg:first").siblings(".fc-content-skeleton").find("thead > tr > td:eq("+a.index()+")"),t=getDayViewLink(e),r=$("<a />").attr("href",t).html(n.html());n.html(r)},renderView=function(e,a){var n=new moment;if("agendaWeek"===e.name){var t=$(".fc-day-header.fc-widget-header",a);t.each(function(){var e=$(this).html(),a=e.split(" ");e=a[0]+" <span>"+a[1]+"</span>";var t=new moment($(this).data("date")),r=getDayViewLink(t),i=$("<a />").attr("href",r).html(e);n.format("YYYYMMDD")===t.format("YYYYMMDD")&&i.addClass("fc-title-today"),$(this).html(i)})}$(".fc-localeButton-button",$solspaceCalendar).addClass("menubtn btn"),"agendaDay"===e.name&&$("thead.fc-head",a).remove()},eventRepositioned=function(e,a,n,t){$.ajax({url:Craft.getCpUrl("calendar/events/api/modify-"+e),type:"post",dataType:"json",data:_defineProperty({eventId:a.id,siteId:a.site.id,isAllDay:a.allDay,startDate:a.start.toISOString(),endDate:a.end?a.end.toISOString():null,deltaSeconds:n.as("seconds")},Craft.csrfTokenName,Craft.csrfTokenValue),success:function(e){e.error?t():a.repeats&&$calendar.fullCalendar("refetchEvents")},error:function(){t()}})},eventDateChange=function(e,a,n){eventRepositioned("date",e,a,n)},eventDurationChange=function(e,a,n){eventRepositioned("duration",e,a,n)},eventClick=function(e){window.location.href=Craft.getCpUrl("calendar/events/"+e.id+"/"+e.site.handle)},getDayViewLink=function(e){if(e.isValid()){var a=e.format("YYYY"),n=e.format("MM"),t=e.format("DD");return Craft.getCpUrl("calendar/view/day/"+a+"/"+n+"/"+t)}return""},getEvents=function(e,a,n,t){getSpinner().fadeIn("fast");var r=$("ul.calendar-list"),i="*";r.length&&(i=$("input:checked",r).map(function(){return $(this).val()}).get().join());var l=$calendar.data(),d=l.currentSiteId;$.ajax({url:Craft.getCpUrl("calendar/month"),data:_defineProperty({rangeStart:e.toISOString(),rangeEnd:a.toISOString(),calendars:i,siteId:d},Craft.csrfTokenName,Craft.csrfTokenValue),type:"post",dataType:"json",success:function(e){var a=!0,n=!1,r=void 0;try{for(var i,l=e.entries()[Symbol.iterator]();!(a=(i=l.next()).done);a=!0){var d=_slicedToArray(i.value,2),o=d[0],s=d[1];s.allDay&&(e[o].end=moment(s.end).add(2,"s").utc().format())}}catch(c){n=!0,r=c}finally{try{!a&&l["return"]&&l["return"]()}finally{if(n)throw r}}t(e),getSpinner().fadeOut("fast")}})},closeAllQTips=function(){qTipsEnabled=!1,$("div.qtip:visible").qtip("hide")},enableQTips=function(){qTipsEnabled=!0},getSpinner=function(){return $solspaceCalendarSpinner||($solspaceCalendar.find(".fc-right").prepend('<div id="solspace-calendar-spinner" class="spinner" style="display: none;"></div>'),$solspaceCalendarSpinner=$("#solspace-calendar-spinner")),$solspaceCalendarSpinner};